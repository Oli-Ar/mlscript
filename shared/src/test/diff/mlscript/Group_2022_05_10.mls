
def f x = (x 1, x "ok")
//│ f: ("ok" -> 'a & 1 -> 'b) -> ('b, 'a,)
//│  = [Function: f]

f (fun x -> (x, x))
//│ res: (("ok" | 1, "ok" | 1,), ("ok" | 1, "ok" | 1,),)
//│    = [ [ 1, 1 ], [ 'ok', 'ok' ] ]

(fun id -> id id 0) (fun x -> x)
//│ ╔══[ERROR] Type mismatch in application:
//│ ║  l.10: 	(fun id -> id id 0) (fun x -> x)
//│ ║        	^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── integer literal of type `0` is not a function
//│ ║  l.10: 	(fun id -> id id 0) (fun x -> x)
//│ ║        	                 ^
//│ ╟── Note: constraint arises from application:
//│ ║  l.10: 	(fun id -> id id 0) (fun x -> x)
//│ ║        	           ^^^^^^^
//│ ╟── from reference:
//│ ║  l.10: 	(fun id -> id id 0) (fun x -> x)
//│ ╙──      	                              ^
//│ res: 'a -> 'a | 0 | error | 'b
//│   where
//│     'a :> 'a -> 'a | 0
//│        <: 0 -> 'b & 'b
//│    = 0

fun id -> id id 0
//│ res: ('a -> 0 -> 'b & 'a) -> 'b
//│    = [Function: res]

fun x -> x
//│ res: 'a -> 'a
//│    = [Function: res]

// forall 'a. 'a -> 'a  <:  'a1 -> 0 -> 'b1 & 'a1
// i.e.
//    forall 'a. 'a -> 'a  <:  'a1 -> 0 -> 'b1
//    forall 'a. 'a -> 'a  <:  'a1
// i.e.
//    'a2 -> 'a2  <:  'a1 -> 0 -> 'b1
//    'a3 -> 'a3  <:  'a1


def g x = x (fun x -> x)
//│ g: ((forall 'a. ('a -> 'a,)) -> 'b) -> 'b
//│  = [Function: g]


def g x y = x (fun x -> y x)
//│ g: ((forall 'a, 'b, 'c. (('b -> 'c,)
//│   where
//│     'a <: 'b -> 'c)) -> 'd) -> 'a -> 'd
//│  = [Function: g1]


self x = x x
//│ self: ('a -> 'b & 'a) -> 'b
//│     = [Function: self]

:e
self self
//│ ╔══[ERROR] Cyclic-looking constraint while typing application
//│ ║  l.63: 	self self
//│ ║        	^^^^^^^^^
//│ ╟── ————————— Additional debugging info: —————————
//│ ╟── this constraint:  ‹∀ 0. (α97' -> α98')›  <:  α108    PolymorphicType  TypeVariable
//│ ╙──  ... looks like:  ‹∀ 0. (α97' -> α98')›  <:  α97'
//│ res: error
//│ Runtime error:
//│   RangeError: Maximum call stack size exceeded

