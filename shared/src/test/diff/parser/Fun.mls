:AllowParseErrors
:AllowTypeErrors // TODO rm


fun f = 1
//│ |#fun| |f| |#=| |1|
//│ Parsed: {fun f = 1}

fun f(x) = x
//│ |#fun| |f|(|x|)| |#=| |x|
//│ Parsed: {fun f = x, => x}

fun f x = x
//│ |#fun| |f| |x| |#=| |x|
//│ ╔══[ERROR] Expected function parameter list; found identifier instead
//│ ║  l.13: 	fun f x = x
//│ ╙──      	      ^
//│ Parsed: {fun f = x}

fun f = x => x
//│ |#fun| |f| |#=| |x| |=>| |x|
//│ Parsed: {fun f = => x x}

// TODO
fun x => x
//│ |#fun| |x| |=>| |x|
//│ ╔══[ERROR] Expected function parameter list; found operator instead
//│ ║  l.25: 	fun x => x
//│ ╙──      	      ^^
//│ ╔══[ERROR] Expected ':' or '=' followed by a function body or signature; found identifier instead
//│ ║  l.25: 	fun x => x
//│ ╙──      	         ^
//│ Parsed: {fun x = undefined}

let f = x => x
//│ |#let| |f| |#=| |x| |=>| |x|
//│ Parsed: {let f = => x x in undefined}

// TODO
let f = fun x => x
//│ |#let| |f| |#=| |#fun| |x| |=>| |x|
//│ ╔══[ERROR] Unexpected 'fun' keyword in expression position
//│ ║  l.40: 	let f = fun x => x
//│ ╙──      	        ^^^
//│ Parsed: {let f = => x x in undefined}


f(x) + x
//│ |f|(|x|)| |+| |x|
//│ Parsed: {+ (f (x,)) x}


fun f(x, y) = x
//│ |#fun| |f|(|x|,| |y|)| |#=| |x|
//│ Parsed: {fun f = x, y, => x}

fun f of x = x
//│ |#fun| |f| |#of| |x| |#=| |x|
//│ Parsed: {fun f = x, => x}

fun f of x, y = x
//│ |#fun| |f| |#of| |x|,| |y| |#=| |x|
//│ Parsed: {fun f = x, y, => x}

fun f x, y = x
//│ |#fun| |f| |x|,| |y| |#=| |x|
//│ ╔══[ERROR] Expected function parameter list; found identifier instead
//│ ║  l.65: 	fun f x, y = x
//│ ╙──      	      ^
//│ ╔══[ERROR] Expected ':' or '=' followed by a function body or signature; found comma instead
//│ ║  l.65: 	fun f x, y = x
//│ ╙──      	       ^
//│ ╔══[ERROR] Expected end of input; found identifier instead
//│ ║  l.65: 	fun f x, y = x
//│ ╙──      	         ^
//│ Parsed: {fun f = undefined}

fun f x y = x
//│ |#fun| |f| |x| |y| |#=| |x|
//│ ╔══[ERROR] Expected function parameter list; found identifier instead
//│ ║  l.78: 	fun f x y = x
//│ ╙──      	      ^
//│ ╔══[ERROR] Expected ':' or '=' followed by a function body or signature; found identifier instead
//│ ║  l.78: 	fun f x y = x
//│ ╙──      	        ^
//│ ╔══[ERROR] Expected end of input; found '=' keyword instead
//│ ║  l.78: 	fun f x y = x
//│ ╙──      	          ^
//│ Parsed: {fun f = undefined}


fun f(x, y)(a, b) = x + y * a / b
//│ |#fun| |f|(|x|,| |y|)|(|a|,| |b|)| |#=| |x| |+| |y| |*| |a| |/| |b|
//│ Parsed: {fun f = x, y, => a, b, => / (+ x (* y a)) b}

fun f(x, y) of a, b = x + y * a / b
//│ |#fun| |f|(|x|,| |y|)| |#of| |a|,| |b| |#=| |x| |+| |y| |*| |a| |/| |b|
//│ Parsed: {fun f = x, y, => a, b, => / (+ x (* y a)) b}

fun f of x, y of a, b = x + y * a / b
//│ |#fun| |f| |#of| |x|,| |y| |#of| |a|,| |b| |#=| |x| |+| |y| |*| |a| |/| |b|
//│ Parsed: {fun f = x, y (a, b,), => / (+ x (* y a)) b}


fun f(Some(x)) = x
//│ |#fun| |f|(|Some|(|x|)|)| |#=| |x|
//│ Parsed: {fun f = Some (x,), => x}

fun f(Some of x) = x
//│ |#fun| |f|(|Some| |#of| |x|)| |#=| |x|
//│ Parsed: {fun f = Some (x,), => x}

fun f of Some of x = x
//│ |#fun| |f| |#of| |Some| |#of| |x| |#=| |x|
//│ Parsed: {fun f = Some (x,), => x}

fun f(Some(x), Some(y)) = x
//│ |#fun| |f|(|Some|(|x|)|,| |Some|(|y|)|)| |#=| |x|
//│ Parsed: {fun f = Some (x,), Some (y,), => x}

fun f(Some of x, Some of y) = x + y
//│ |#fun| |f|(|Some| |#of| |x|,| |Some| |#of| |y|)| |#=| |x| |+| |y|
//│ Parsed: {fun f = Some (x, Some (y,),), => + x y}

fun f of Some of x, Some of y = x + y
//│ |#fun| |f| |#of| |Some| |#of| |x|,| |Some| |#of| |y| |#=| |x| |+| |y|
//│ Parsed: {fun f = Some (x, Some (y,),), => + x y}


fun f(x: Int, y: Int) = x
//│ |#fun| |f|(|x|#:| |Int|,| |y|#:| |Int|)| |#=| |x|
//│ Parsed: {fun f = x: Int, y: Int, => x}

fun f(x: Int, y: Int): Int = x
//│ |#fun| |f|(|x|#:| |Int|,| |y|#:| |Int|)|#:| |Int| |#=| |x|
//│ Parsed: {fun f = x: Int, y: Int, => x : TypeName(Int)}



fun 1
//│ |#fun| |1|
//│ ╔══[ERROR] Expected a function name; found literal instead
//│ ║  l.140: 	fun 1
//│ ╙──       	    ^
//│ Parsed: {fun <error> = undefined}

fun 1 = 1
//│ |#fun| |1| |#=| |1|
//│ ╔══[ERROR] Expected a function name; found literal instead
//│ ║  l.147: 	fun 1 = 1
//│ ╙──       	    ^
//│ Parsed: {fun <error> = 1}

fun
//│ |#fun|
//│ ╔══[ERROR] Expected a function name; found end of input instead
//│ ║  l.154: 	fun
//│ ╙──       	   ^
//│ Parsed: {fun <error> = undefined}

fun = 1
//│ |#fun| |#=| |1|
//│ ╔══[ERROR] Expected a function name; found '=' keyword instead
//│ ║  l.161: 	fun = 1
//│ ╙──       	    ^
//│ Parsed: {fun <error> = undefined}



